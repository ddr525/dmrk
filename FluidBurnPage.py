import customtkinter as ctk

from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
import matplotlib.pyplot as plt

from functools import partial

import numpy as np

from DatasetWindow import DatasetWindow

from utilities import toFixed

class FluidBurnPage(ctk.CTkScrollableFrame):

    def _size(self, event): 
        if(event.width > 1800):
            if(self.zoomed != True):
                self.small_row_size = 4
                self.large_row_size = 5
                self.need_resize = True
                self.zoomed = True
                self.larger = False
                self.small = False
        elif(event.width > 1500):
            if(self.larger != True):
                self.small_row_size = 3
                self.large_row_size = 4
                self.need_resize = True
                self.zoomed = False
                self.small = False
                self.larger = True
        elif(event.width < 1250):
            if(self.small != True):
                self.small_row_size = 1
                self.large_row_size = 2
                self.need_resize = True
                self.small = True
                self.zoomed = False
                self.larger = False
        else:
            if(self.zoomed or self.larger or self.small):
                self.small_row_size = 2
                self.large_row_size = 3
                self.need_resize = True
                self.zoomed = False
                self.larger = False
                self.small = False

        if(self.need_resize):
            # Вычисление размеров карточек
            self.card_size = max(200, event.width // (self.small_row_size * 5))  # Минимальный размер 200
            self.chart_size = max(2, self.card_size // 100)               # Пропорциональный размер диаграмм
            self.update(self.data)
            self.need_resize = False


    def __init__(self, master, root, database, **kwargs):
        super().__init__(master, **kwargs)

        self.database = database
        self.root = root

        self.columnconfigure((0, 1), weight=1)

        self.figures = []

        self.master = master

        self.zoomed = False
        self.larger = False
        self.small = False
        self.need_resize = False

        self.small_row_size = 2
        self.large_row_size = 3

        self.card_size = 300
        self.chart_size = 2

        if(self.database.get_experiment_number() != 0):
            self.start_up()
        else:
            data = [
                ("Доля природного газа, %", toFixed(7.1, 1)),
                ("Доля доменного газа, %", toFixed(92.9, 1)),
                ("cards", {
                    "CO₂": 21.4,
                    "N₂": 67.5,
                    "H₂O": 10.5,
                    "O₂": 0.6,
                }),
                ("Низшая рабочая теплота\nсгорания ПГ, ккал/м³ (при 20°C)", toFixed(8094, 3)),
                ("Низшая рабочая теплота\nсгорания ДГ, ккал/м³ (при 20°C)", toFixed(825, 3)),
                ("Низшая рабочая теплота\nсгорания смеси, ккал/м³ (при 20°C)", toFixed(1341, 3)),
                ("Цена смешанного газа, тг/1000м³", toFixed(71.67, 1)),
                ("Плотность газа при н.у., кг/м³", toFixed(1.218, 3)),
                ("Действительный расход воздуха, м³/м³", toFixed(1.43, 3)),
                ("Удельный выход дыма, м³/м³", toFixed(2.40, 3)),
                ["Теплоёмкость дыма, Дж/(м³·К)", toFixed(1624, 3)],
                ["Калориметрическая температура, °C", toFixed(1997, 3)],
                ["Действительная температура, °C", toFixed(1250, 3)],
            ]
            self.heating_data = {'Расчет нагрева металла': {'Методическая зона': {'tпечи, °C': '1050.0 - 1300.0', 'tпов1, °C': np.float64(877.9069578249016), 'tпов2, °C': np.float64(738.0442610991955), 'Tц, °C': np.float64(620.8558740561331), 'tниз, °C': '727.0 - 1100.0'}, 'Первая сварочная зона': {'tпечи, °C': '1300.0 - 1350.0', 'tпов1, °C': np.float64(1275.6667427629054), 'tпов2, °C': np.float64(1199.7507045894156), 'Tц, °C': np.float64(1165.0111286280853), 'tниз, °C': '777.0 - 1250.0'}, 'Вторая сварочная зона': {'tпечи, °C': 1350.0, 'tпов1, °C': np.float64(1333.1286042411639), 'tпов2, °C': np.float64(1263.0348841095013), 'Tц, °C': np.float64(1290.465163724269), 'tниз, °C': 1250.0}, 'Томильная зона': {'tпечи, °C': 1280.0, 'tпов1, °C': np.float64(1281.469103176239), 'tпов2, °C': np.float64(1284.9247036730524), 'Tц, °C': np.float64(1284.168626883073), 'tниз, °C': 1250.0}, 'Время нагрева, ч:м': '4 : 0', 'Масса сляба, т': '17.321', 'Производительность печи, т/час': '123.13', 'Среднемассовая температура металла, °C': '1284', 'Температура раската за пятой клетью, °C': ' 877', 'Конечный перепад температур, °C': '-2.7', 'Максимальный перепад температур, °C': '272', 'Кол-во теплоты получаемое металлом, кДж/кг': '905', 'Расход топлива на печь, тыс. м³/час': '54.15', 'Расход топлива по зонам:': {'в первой сварочной зоне, тыс. м³/час': '20.413', 'в первой сварочной зоне, %': '37.7', 'во второй сварочной зоне, тыс. м³/час': '5.824', 'во второй сварочной зоне, %': '10.8', 'в томильной зоне, тыс. м³/час': '3.379', 'в томильной зоне, %': '6.2', 'в зоне нижнего подогрева, тыс. м³/час': '24.531', 'в зоне нижнего подогрева, %': '45.3'}, 'Удельный расход топлива, м³/т': '440', 'Удельный расход природного газа, м³/т': '0', 'Себестоимость нагрева, тг/т': '1338.39', 'КПД нагрева, %': ' 35.9'}, 'Тепловой баланс': {'Методическая зона': {'Приход тепла': {'Тепло транзитных газов, MВт': '10.63', 'Тепло транзитных газов, %': '100.0', 'Итого приход, MВт': '10.63', 'Итого приход, %': '100.0'}, 'Расход тепла': {'Тепло на нагрев металла, MВт': ' 5.87', 'Тепло на нагрев металла, %': ' 55.2', 'Потери через кладку, MВт': ' 0.28', 'Потери через кладку, %': '  2.7', 'Потери через СИО, MВт': ' 3.80', 'Потери через СИО, %': ' 35.7', 'Потери через окно посада, MВт': ' 0.69', 'Потери через окно посада, %': '  6.4', 'Итого расход, MВт': '10.63', 'Итого расход, %': '100.0'}}, 'Первая сварочная зона': {'Приход тепла': {'Химическое тепло топлива, MВт': '29.36', 'Химическое тепло топлива, %': ' 89.0', 'Физическое тепло воздуха, MВт': ' 3.00', 'Физическое тепло воздуха, %': '  9.1', 'Физическое тепло газа, MВт': ' 0.15', 'Физическое тепло газа, %': '  0.5', 'Тепло транзитных газов, MВт': ' 0.47', 'Тепло транзитных газов, %': '  1.4', 'Итого приход, MВт': '32.98', 'Итого приход, %': '100.0'}, 'Расход тепла': {'Тепло на нагрев металла, MВт': ' 5.85', 'Тепло на нагрев металла, %': ' 21.3', 'Потери через кладку, MВт': ' 0.52', 'Потери через кладку, %': '  1.6', 'Тепло уходящее с дымом, MВт': '24.79', 'Тепло уходящее с дымом, %': ' 75.2', 'Потери через СИО, MВт': ' 0.66', 'Потери через СИО, %': '  2.0', 'Итого расход, MВт': '32.98', 'Итого расход, %': '100.0'}, 'Расход топлива, тыс. м³/час': '20.413'}, 'Вторая сварочная зона': {'Приход тепла': {'Химическое тепло топлива, MВт': ' 8.38', 'Химическое тепло топлива, %': ' 92.7', 'Физическое тепло воздуха, MВт': ' 0.86', 'Физическое тепло воздуха, %': '  9.5', 'Физическое тепло газа, MВт': ' 0.04', 'Физическое тепло газа, %': '  0.5', 'Тепло транзитных газов, MВт': '-0.24', 'Тепло транзитных газов, %': ' -2.6', 'Итого приход, MВт': ' 9.04', 'Итого приход, %': '100.0'}, 'Расход тепла': {'Тепло на нагрев металла, MВт': ' 0.88', 'Тепло на нагрев металла, %': '  9.7', 'Потери через кладку, MВт': ' 0.79', 'Потери через кладку, %': '  8.7', 'Тепло уходящее с дымом, MВт': ' 7.37', 'Тепло уходящее с дымом, %': ' 81.5', 'Итого расход, MВт': ' 9.04', 'Итого расход, %': '100.0'}, 'Расход топлива, тыс. м³/час': '5.824'}, 'Томильная зона': {'Приход тепла': {'Химическое тепло топлива, MВт': ' 4.86', 'Химическое тепло топлива, %': ' 90.3', 'Физическое тепло воздуха, MВт': ' 0.50', 'Физическое тепло воздуха, %': '  9.2', 'Физическое тепло газа, MВт': ' 0.03', 'Физическое тепло газа, %': '  0.5', 'Итого приход, MВт': ' 5.38', 'Итого приход, %': '100.0'}, 'Расход тепла': {'Тепло на нагрев металла, MВт': '-0.22', 'Тепло на нагрев металла, %': ' -4.1', 'Потери через кладку, MВт': ' 0.44', 'Потери через кладку, %': '  8.2', 'Тепло уходящее с дымом, MВт': ' 4.04', 'Тепло уходящее с дымом, %': ' 75.0', 'Потери через окно выдачи, MВт': ' 1.13', 'Потери через окно выдачи, %': ' 20.9', 'Итого расход, MВт': ' 5.38', 'Итого расход, %': '100.0'}, 'Расход топлива, тыс. м³/час': '3.379'}, 'Зона нижнего подогрева': {'Приход тепла': {'Химическое тепло топлива, MВт': '35.28', 'Химическое тепло топлива, %': ' 90.3', 'Физическое тепло воздуха, MВт': ' 3.61', 'Физическое тепло воздуха, %': '  9.2', 'Физическое тепло газа, MВт': ' 0.19', 'Физическое тепло газа, %': '  0.5', 'Итого приход, MВт': '39.08', 'Итого приход, %': '100.0'}, 'Расход тепла': {'Тепло на нагрев металла, MВт': ' 1.15', 'Тепло на нагрев металла, %': '  2.9', 'Тепло уходящее с дымом, MВт': '28.56', 'Тепло уходящее с дымом, %': ' 73.1', 'Потери через СИО, MВт': ' 9.37', 'Потери через СИО, %': ' 24.0', 'Итого расход, MВт': '39.08', 'Итого расход, %': '100.0'}, 'Расход топлива, тыс. м³/час': '24.531'}, 'Тепловой баланс печи': {'Приход тепла': {'Химическое тепло топлива, MВт': '77.88', 'Химическое тепло топлива, %': ' 90.3', 'Физическое тепло воздуха, MВт': ' 7.97', 'Физическое тепло воздуха, %': '  9.2', 'Физическое тепло газа, MВт': ' 0.41', 'Физическое тепло газа, %': '  0.5', 'Итого приход, MВт': '86.25', 'Итого приход, %': '100.0'}, 'Расход тепла': {'Тепло на нагрев металла, MВт': '30.95', 'Тепло на нагрев металла, %': ' 29.6', 'Потери через кладку, MВт': ' 2.03', 'Потери через кладку, %': '  1.9', 'Тепло уходящее с дымом, MВт': '52.22', 'Тепло уходящее с дымом, %': ' 49.9', 'Потери через СИО, MВт': '17.55', 'Потери через СИО, %': ' 16.8', 'Потери излучением ч/з окна, MВт': ' 1.13', 'Потери излучением ч/з окна, %': '  1.7', 'Итого расход, MВт': '104.55', 'Итого расход, %': '100.0'}, 'Расход топлива, тыс. м³/час': '54.15'}}, 'График': {'t': np.array([  0. ,   0.5,   1. ,   1.5,   2. ,   2.5,   3. ,   3.5,   4. ,
                4.5,   5. ,   5.5,   6. ,   6.5,   7. ,   7.5,   8. ,   8.5,
                9. ,   9.5,  10. ,  10.5,  11. ,  11.5,  12. ,  12.5,  13. ,
                13.5,  14. ,  14.5,  15. ,  15.5,  16. ,  16.5,  17. ,  17.5,
                18. ,  18.5,  19. ,  19.5,  20. ,  20.5,  21. ,  21.5,  22. ,
                22.5,  23. ,  23.5,  24. ,  24.5,  25. ,  25.5,  26. ,  26.5,
                27. ,  27.5,  28. ,  28.5,  29. ,  29.5,  30. ,  30.5,  31. ,
                31.5,  32. ,  32.5,  33. ,  33.5,  34. ,  34.5,  35. ,  35.5,
                36. ,  36.5,  37. ,  37.5,  38. ,  38.5,  39. ,  39.5,  40. ,
                40.5,  41. ,  41.5,  42. ,  42.5,  43. ,  43.5,  44. ,  44.5,
                45. ,  45.5,  46. ,  46.5,  47. ,  47.5,  48. ,  48.5,  49. ,
                49.5,  50. ,  50.5,  51. ,  51.5,  52. ,  52.5,  53. ,  53.5,
                54. ,  54.5,  55. ,  55.5,  56. ,  56.5,  57. ,  57.5,  58. ,
                58.5,  59. ,  59.5,  60. ,  60.5,  61. ,  61.5,  62. ,  62.5,
                63. ,  63.5,  64. ,  64.5,  65. ,  65.5,  66. ,  66.5,  67. ,
                67.5,  68. ,  68.5,  69. ,  69.5,  70. ,  70.5,  71. ,  71.5,
                72. ,  72.5,  73. ,  73.5,  74. ,  74.5,  75. ,  75.5,  76. ,
                76.5,  77. ,  77.5,  78. ,  78.5,  79. ,  79.5,  80. ,  80.5,
                81. ,  81.5,  82. ,  82.5,  83. ,  83.5,  84. ,  84.5,  85. ,
                85.5,  86. ,  86.5,  87. ,  87.5,  88. ,  88.5,  89. ,  89.5,
                90. ,  90.5,  91. ,  91.5,  92. ,  92.5,  93. ,  93.5,  94. ,
                94.5,  95. ,  95.5,  96. ,  96.5,  97. ,  97.5,  98. ,  98.5,
                99. ,  99.5, 100. , 100.5, 101. , 101.5, 102. , 102.5, 103. ,
                103.5, 104. , 104.5, 105. , 105.5, 106. , 106.5, 107. , 107.5,
                108. , 108.5, 109. , 109.5, 110. , 110.5, 111. , 111.5, 112. ,
                112.5, 113. , 113.5, 114. , 114.5, 115. , 115.5, 116. , 116.5,
                117. , 117.5, 118. , 118.5, 119. , 119.5, 120. , 120.5, 121. ,
                121.5, 122. , 122.5, 123. , 123.5, 124. , 124.5, 125. , 125.5,
                126. , 126.5, 127. , 127.5, 128. , 128.5, 129. , 129.5, 130. ,
                130.5, 131. , 131.5, 132. , 132.5, 133. , 133.5, 134. , 134.5,
                135. , 135.5, 136. , 136.5, 137. , 137.5, 138. , 138.5, 139. ,
                139.5, 140. , 140.5, 141. , 141.5, 142. , 142.5, 143. , 143.5,
                144. , 144.5, 145. , 145.5, 146. , 146.5, 147. , 147.5, 148. ,
                148.5, 149. , 149.5, 150. , 150.5, 151. , 151.5, 152. , 152.5,
                153. , 153.5, 154. , 154.5, 155. , 155.5, 156. , 156.5, 157. ,
                157.5, 158. , 158.5, 159. , 159.5, 160. , 160.5, 161. , 161.5,
                162. , 162.5, 163. , 163.5, 164. , 164.5, 165. , 165.5, 166. ,
                166.5, 167. , 167.5, 168. , 168.5, 169. , 169.5, 170. , 170.5,
                171. , 171.5, 172. , 172.5, 173. , 173.5, 174. , 174.5, 175. ,
                175.5, 176. , 176.5, 177. , 177.5, 178. , 178.5, 179. , 179.5,
                180. , 180.5, 181. , 181.5, 182. , 182.5, 183. , 183.5, 184. ,
                184.5, 185. , 185.5, 186. , 186.5, 187. , 187.5, 188. , 188.5,
                189. , 189.5, 190. , 190.5, 191. , 191.5, 192. , 192.5, 193. ,
                193.5, 194. , 194.5, 195. , 195.5, 196. , 196.5, 197. , 197.5,
                198. , 198.5, 199. , 199.5, 200. , 200.5, 201. , 201.5, 202. ,
                202.5, 203. , 203.5, 204. , 204.5, 205. , 205.5, 206. , 206.5,
                207. , 207.5, 208. , 208.5, 209. , 209.5, 210. , 210.5, 211. ,
                211.5, 212. , 212.5, 213. , 213.5, 214. , 214.5, 215. , 215.5,
                216. , 216.5, 217. , 217.5, 218. , 218.5, 219. , 219.5, 220. ,
                220.5, 221. , 221.5, 222. , 222.5, 223. , 223.5, 224. , 224.5,
                225. , 225.5, 226. , 226.5, 227. , 227.5, 228. , 228.5, 229. ,
                229.5, 230. , 230.5, 231. , 231.5, 232. , 232.5, 233. , 233.5,
                234. , 234.5, 235. , 235.5, 236. , 236.5, 237. , 237.5, 238. ,
                238.5, 239. , 239.5]), 'время': 240.0, 'Печь (верх)': np.array([   0.        , 1050.        , 1052.91946936, 1055.83893871,
                1058.75840807, 1061.67787743, 1064.59734679, 1067.51681614,
                1070.4362855 , 1073.35575486, 1076.27522422, 1079.19469357,
                1082.11416293, 1085.03363229, 1087.95310164, 1090.872571  ,
                1093.79204036, 1096.71150972, 1099.63097907, 1102.55044843,
                1105.46991779, 1108.38938714, 1111.3088565 , 1114.22832586,
                1117.14779522, 1120.06726457, 1122.98673393, 1125.90620329,
                1128.82567265, 1131.745142  , 1134.66461136, 1137.58408072,
                1140.50355007, 1143.42301943, 1146.34248879, 1149.26195815,
                1152.1814275 , 1155.10089686, 1158.02036622, 1160.93983558,
                1163.85930493, 1166.77877429, 1169.69824365, 1172.617713  ,
                1175.53718236, 1178.45665172, 1181.37612108, 1184.29559043,
                1187.21505979, 1190.13452915, 1193.05399851, 1195.97346786,
                1198.89293722, 1201.81240658, 1204.73187593, 1207.65134529,
                1210.57081465, 1213.49028401, 1216.40975336, 1219.32922272,
                1222.24869208, 1225.16816143, 1228.08763079, 1231.00710015,
                1233.92656951, 1236.84603886, 1239.76550822, 1242.68497758,
                1245.60444694, 1248.52391629, 1251.44338565, 1254.36285501,
                1257.28232436, 1260.20179372, 1263.12126308, 1266.04073244,
                1268.96020179, 1271.87967115, 1274.79914051, 1277.71860987,
                1280.63807922, 1283.55754858, 1286.47701794, 1289.39648729,
                1292.31595665, 1295.23542601, 1298.15489537, 1300.        ,
                1301.        , 1301.        , 1301.        , 1302.        ,
                1302.        , 1302.        , 1303.        , 1303.        ,
                1303.        , 1304.        , 1304.        , 1305.        ,
                1305.        , 1305.        , 1306.        , 1306.        ,
                1306.        , 1307.        , 1307.        , 1308.        ,
                1308.        , 1308.        , 1309.        , 1309.        ,
                1309.        , 1310.        , 1310.        , 1310.        ,
                1311.        , 1311.        , 1312.        , 1312.        ,
                1312.        , 1313.        , 1313.        , 1313.        ,
                1314.        , 1314.        , 1315.        , 1315.        ,
                1315.        , 1316.        , 1316.        , 1316.        ,
                1317.        , 1317.        , 1317.        , 1318.        ,
                1318.        , 1319.        , 1319.        , 1319.        ,
                1320.        , 1320.        , 1320.        , 1321.        ,
                1321.        , 1322.        , 1322.        , 1322.        ,
                1323.        , 1323.        , 1323.        , 1324.        ,
                1324.        , 1324.        , 1325.        , 1325.        ,
                1326.        , 1326.        , 1326.        , 1327.        ,
                1327.        , 1327.        , 1328.        , 1328.        ,
                1329.        , 1329.        , 1329.        , 1330.        ,
                1330.        , 1330.        , 1331.        , 1331.        ,
                1331.        , 1332.        , 1332.        , 1333.        ,
                1333.        , 1333.        , 1334.        , 1334.        ,
                1334.        , 1335.        , 1335.        , 1336.        ,
                1336.        , 1336.        , 1337.        , 1337.        ,
                1337.        , 1338.        , 1338.        , 1338.        ,
                1339.        , 1339.        , 1340.        , 1340.        ,
                1340.        , 1341.        , 1341.        , 1341.        ,
                1342.        , 1342.        , 1343.        , 1343.        ,
                1343.        , 1344.        , 1344.        , 1344.        ,
                1345.        , 1345.        , 1345.        , 1346.        ,
                1346.        , 1347.        , 1347.        , 1347.        ,
                1348.        , 1348.        , 1348.        , 1349.        ,
                1349.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1350.        , 1350.        , 1350.        , 1350.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ,
                1280.        , 1280.        , 1280.        , 1280.        ]), 'Печь (низ)': np.array([   0.        ,  727.        ,  731.35584828,  735.71169656,
                    740.06754484,  744.42339312,  748.77924141,  753.13508969,
                    757.49093797,  761.84678625,  766.20263453,  770.55848281,
                    774.91433109,  779.27017937,  783.62602765,  787.98187593,
                    792.33772422,  796.6935725 ,  801.04942078,  805.40526906,
                    809.76111734,  814.11696562,  818.4728139 ,  822.82866218,
                    827.18451046,  831.54035874,  835.89620703,  840.25205531,
                    844.60790359,  848.96375187,  853.31960015,  857.67544843,
                    862.03129671,  866.38714499,  870.74299327,  875.09884155,
                    879.45468984,  883.81053812,  888.1663864 ,  892.52223468,
                    896.87808296,  901.23393124,  905.58977952,  909.9456278 ,
                    914.30147608,  918.65732436,  923.01317265,  927.36902093,
                    931.72486921,  936.08071749,  940.43656577,  944.79241405,
                    949.14826233,  953.50411061,  957.85995889,  962.21580717,
                    966.57165546,  970.92750374,  975.28335202,  979.6392003 ,
                    983.99504858,  988.35089686,  992.70674514,  997.06259342,
                1001.4184417 , 1005.77428999, 1010.13013827, 1014.48598655,
                1018.84183483, 1023.19768311, 1027.55353139, 1031.90937967,
                1036.26522795, 1040.62107623, 1044.97692451, 1049.3327728 ,
                1053.68862108, 1058.04446936, 1062.40031764, 1066.75616592,
                1071.1120142 , 1075.46786248, 1079.82371076, 1084.17955904,
                1088.53540732, 1092.89125561, 1097.24710389, 1100.4069356 ,
                1101.51273885, 1102.61854211, 1103.72434536, 1104.83014862,
                1105.93595188, 1107.04175513, 1108.14755839, 1109.25336164,
                1110.3591649 , 1111.46496815, 1112.57077141, 1113.67657466,
                1114.78237792, 1115.88818117, 1116.99398443, 1118.09978769,
                1119.20559094, 1120.3113942 , 1121.41719745, 1122.52300071,
                1123.62880396, 1124.73460722, 1125.84041047, 1126.94621373,
                1128.05201699, 1129.15782024, 1130.2636235 , 1131.36942675,
                1132.47523001, 1133.58103326, 1134.68683652, 1135.79263977,
                1136.89844303, 1138.00424628, 1139.11004954, 1140.2158528 ,
                1141.32165605, 1142.42745931, 1143.53326256, 1144.63906582,
                1145.74486907, 1146.85067233, 1147.95647558, 1149.06227884,
                1150.16808209, 1151.27388535, 1152.37968861, 1153.48549186,
                1154.59129512, 1155.69709837, 1156.80290163, 1157.90870488,
                1159.01450814, 1160.12031139, 1161.22611465, 1162.33191791,
                1163.43772116, 1164.54352442, 1165.64932767, 1166.75513093,
                1167.86093418, 1168.96673744, 1170.07254069, 1171.17834395,
                1172.2841472 , 1173.38995046, 1174.49575372, 1175.60155697,
                1176.70736023, 1177.81316348, 1178.91896674, 1180.02476999,
                1181.13057325, 1182.2363765 , 1183.34217976, 1184.44798301,
                1185.55378627, 1186.65958953, 1187.76539278, 1188.87119604,
                1189.97699929, 1191.08280255, 1192.1886058 , 1193.29440906,
                1194.40021231, 1195.50601557, 1196.61181883, 1197.71762208,
                1198.82342534, 1199.92922859, 1201.03503185, 1202.1408351 ,
                1203.24663836, 1204.35244161, 1205.45824487, 1206.56404812,
                1207.66985138, 1208.77565464, 1209.88145789, 1210.98726115,
                1212.0930644 , 1213.19886766, 1214.30467091, 1215.41047417,
                1216.51627742, 1217.62208068, 1218.72788393, 1219.83368719,
                1220.93949045, 1222.0452937 , 1223.15109696, 1224.25690021,
                1225.36270347, 1226.46850672, 1227.57430998, 1228.68011323,
                1229.78591649, 1230.89171975, 1231.997523  , 1233.10332626,
                1234.20912951, 1235.31493277, 1236.42073602, 1237.52653928,
                1238.63234253, 1239.73814579, 1240.84394904, 1241.9497523 ,
                1243.05555556, 1244.16135881, 1245.26716207, 1246.37296532,
                1247.47876858, 1248.58457183, 1249.69037509, 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ,
                1250.        , 1250.        , 1250.        , 1250.        ]), 'Металл (верх)': np.array([   0.        ,   35.19944219,   80.88208301,  107.2417234 ,
                    127.83993923,  145.65946862,  161.74937374,  176.64132404,
                    190.65964964,  204.02403385,  216.89257763,  229.382856  ,
                    241.5836886 ,  253.56252159,  265.37047723,  277.04601596,
                    288.61768983,  300.10625692,  311.52632345,  322.88762562,
                    334.19603166,  345.45432502,  356.66281639,  367.81982343,
                    378.92204978,  389.96489006,  400.94268244,  411.84892687,
                    422.67648278,  433.41775662,  444.06488559,  454.60992063,
                    465.0450077 ,  475.36256428,  485.55544529,  495.61709218,
                    505.5416589 ,  515.32410968,  524.96028551,  534.44693866,
                    543.78173657,  552.96323852,  561.99084976,  570.86475835,
                    579.58586009,  588.15567664,  596.57627111,  604.85016458,
                    612.98025638,  620.96974974,  628.82208416,  636.54087501,
                    644.12986038,  651.59285526,  658.93371232,  666.15628904,
                    673.26442045,  680.2618968 ,  687.15244567,  693.93971785,
                    700.62727647,  708.55525306,  716.01675531,  723.23457956,
                    730.29403121,  737.2317917 ,  744.06578028,  750.80601133,
                    757.45886739,  764.02891792,  770.51975386,  776.93439812,
                    783.27552035,  789.54555539,  795.9089601 ,  802.59200839,
                    809.33708916,  816.05560816,  822.72301737,  829.33405825,
                    835.8889391 ,  842.38914878,  848.8362628 ,  855.23166058,
                    861.57650473,  867.87178387,  874.13281632,  880.88626991,
                    887.63816689,  893.83169148,  899.70398655,  905.34880386,
                    910.80987557,  916.11165575,  921.27010184,  926.29682752,
                    931.20339441,  936.0126363 ,  940.74406405,  945.40630946,
                    950.00175963,  954.530446  ,  958.99192045,  963.38604064,
                    967.7148368 ,  971.98354618,  976.19771471,  980.36153062,
                    984.47833334,  988.55144562,  992.58417361,  996.57949954,
                1000.53987789, 1004.46719368, 1008.36282228, 1012.22772862,
                1016.06256833, 1019.86777457, 1023.64362613, 1027.39029821,
                1031.1078988 , 1034.79649423, 1038.45612666, 1042.08682579,
                1045.68861663, 1049.26152432, 1052.80557719, 1056.32080842,
                1059.80725692, 1063.26496761, 1066.69399138, 1070.09438488,
                1073.4662101 , 1076.80953405, 1080.12442832, 1083.41096867,
                1086.66923472, 1089.8993096 , 1093.10127969, 1096.2752344 ,
                1099.42126593, 1102.53946915, 1105.62994145, 1108.69278264,
                1111.72809486, 1114.73598255, 1117.71655237, 1120.66991317,
                1123.596176  , 1126.49545409, 1129.3678628 , 1132.21351969,
                1135.03254447, 1137.82505901, 1140.59118737, 1143.33105577,
                1146.04479263, 1148.73252853, 1151.39439626, 1154.03053076,
                1156.64106917, 1159.22615076, 1161.78591701, 1164.32051148,
                1166.8300799 , 1169.31477009, 1171.77473195, 1174.21011743,
                1176.6210805 , 1179.00777716, 1181.37036533, 1183.70900486,
                1186.02385751, 1188.31508684, 1190.58285825, 1192.82733885,
                1195.04869749, 1197.24710464, 1199.42273239, 1201.57575438,
                1203.70634574, 1205.81468303, 1207.9009442 , 1209.96530852,
                1212.00795652, 1214.02906995, 1216.0288317 , 1218.00742573,
                1219.96503704, 1221.90185158, 1223.81805621, 1225.71383862,
                1227.58938728, 1229.44489137, 1231.28054073, 1233.09652579,
                1234.8930375 , 1236.67026728, 1238.42840696, 1240.16764873,
                1241.88818504, 1243.59020859, 1245.27391224, 1246.93948896,
                1248.58713178, 1250.21703372, 1251.82938775, 1253.42438671,
                1255.0022233 , 1256.56308998, 1258.10717893, 1259.63468202,
                1261.14579075, 1262.64069617, 1264.11958888, 1265.58265896,
                1267.0300959 , 1268.46208861, 1269.87882533, 1271.28049359,
                1272.66728019, 1274.03937116, 1275.39695168, 1277.17403867,
                1278.64128534, 1279.94335056, 1281.16603596, 1282.33666085,
                1283.46718946, 1284.56428395, 1285.63223178, 1286.6740366 ,
                1287.69191696, 1288.68756975, 1289.66232477, 1290.61724309,
                1291.55318387, 1292.47085212, 1293.3708341 , 1294.25362427,
                1295.11964607, 1295.96926815, 1296.80281703, 1297.62058704,
                1298.4228481 , 1299.20985173, 1299.98183578, 1300.739028  ,
                1301.48164884, 1302.20991349, 1302.92403348, 1303.62421779,
                1304.31067368, 1304.98360724, 1305.64322381, 1306.28972813,
                1306.92332454, 1307.54421695, 1308.15260882, 1308.74870311,
                1309.33270219, 1309.90480766, 1310.46522028, 1311.0141398 ,
                1311.55176482, 1312.07829268, 1312.59391929, 1313.09883905,
                1313.59324468, 1314.07732716, 1314.5512756 , 1315.01527716,
                1315.46951695, 1315.914178  , 1316.34944112, 1316.77548492,
                1317.1924857 , 1317.60061743, 1318.00005171, 1318.39095776,
                1318.77350233, 1319.14784975, 1319.51416188, 1319.87259811,
                1320.22331534, 1320.56646797, 1320.90220796, 1321.23068473,
                1321.55204528, 1321.8664341 , 1322.17399326, 1322.47486236,
                1322.7691786 , 1323.05707677, 1323.33868926, 1323.61414611,
                1323.883575  , 1324.14710132, 1324.40484812, 1324.65693621,
                1324.90348416, 1325.14460831, 1325.38042281, 1325.61103965,
                1325.8365687 , 1326.0571177 , 1326.27279235, 1326.48369627,
                1326.6899311 , 1326.89159646, 1327.08879003, 1327.28160758,
                1327.47014296, 1327.65448817, 1327.83473337, 1328.0109669 ,
                1328.18327536, 1328.35174357, 1328.51645465, 1328.67749003,
                1328.83492947, 1328.98885112, 1329.13933152, 1329.28644562,
                1329.43026687, 1329.57086715, 1329.70831689, 1329.84268503,
                1329.9740391 , 1330.10244521, 1330.22796807, 1330.35067106,
                1330.47061621, 1330.58786425, 1330.70247464, 1330.81450557,
                1330.92401399, 1331.03105566, 1331.13568514, 1331.23795584,
                1331.33792001, 1331.43562881, 1331.53113228, 1331.62447941,
                1331.71571811, 1331.80489528, 1331.89205681, 1331.97724758,
                1332.06051153, 1332.14189162, 1332.22142989, 1332.29916748,
                1332.37514461, 1332.44940066, 1332.52197412, 1332.59290265,
                1332.6622231 , 1332.72997149, 1332.79618309, 1332.86089236,
                1332.92413301, 1332.98593804, 1333.04633968, 1333.1053695 ,
                1320.42232799, 1311.25939171, 1306.63441538, 1303.55180711,
                1301.22106909, 1299.3457132 , 1297.78055579, 1296.44190341,
                1295.27656828, 1294.24852329, 1293.33220998, 1292.50882703,
                1291.76412353, 1291.08701856, 1290.46870337, 1289.90203873,
                1289.38113959, 1288.90108223, 1288.45769319, 1288.04739454,
                1287.66708813, 1287.31406779, 1286.98595154, 1286.68062861,
                1286.39621747, 1286.13103211, 1285.88355478, 1285.65241355,
                1285.43636387, 1285.23427306, 1285.04510736, 1284.86792093,
                1284.70184642, 1284.5460869 , 1284.39990889, 1284.26263623,
                1284.1336448 , 1284.01235782, 1283.89824167, 1283.79080226,
                1283.68958166, 1283.59415522, 1283.50412886, 1283.41913669,
                1283.33883881, 1283.26291935, 1283.19108466, 1283.12306163,
                1283.05859623, 1282.99745207, 1282.93940914, 1282.88426264,
                1282.83182191, 1282.78190937, 1282.73435968, 1282.6890188 ,
                1282.64574325, 1282.60439935, 1282.56486255, 1282.52701679,
                1282.49075392, 1282.45597313, 1282.42258047, 1282.39048837,
                1282.35961519, 1282.32988483, 1282.30122635, 1282.27357358,
                1282.24686484, 1282.22104261, 1282.19605325, 1282.17184673,
                1282.14837639, 1282.12559869, 1282.10347304, 1282.08196155,
                1282.06102889, 1282.04064206, 1282.02077029, 1282.00138486,
                1281.98245896, 1281.96396754, 1281.94588726, 1281.92819627,
                1281.91087422, 1281.89390206, 1281.87726201, 1281.86093746,
                1281.84491289, 1281.82917379, 1281.8137066 , 1281.79849863,
                1281.78353803, 1281.76881369, 1281.75431524, 1281.74003297,
                1281.72595778, 1281.71208116, 1281.69839512, 1281.6848922 ,
                1281.6715654 , 1281.65840813, 1281.64541425, 1281.63257798,
                1281.61989388, 1281.60735688, 1281.59496217, 1281.58270526,
                1281.57058193, 1281.55858819, 1281.5467203 , 1281.53497473,
                1281.52334815, 1281.51183743, 1281.50043961, 1281.4891519 ]), 'Металл (центр)': np.array([   0.        ,   20.        ,   20.00508556,   20.19551208,
                    20.99532419,   22.67303724,   25.28305554,   28.7692141 ,
                    33.03883806,   37.99692618,   43.55887069,   49.65379137,
                    56.22415407,   63.22407691,   70.61729776,   78.37518102,
                    86.47489698,   94.89780697,  103.62804816,  112.65129878,
                    121.95370385,  131.52094591,  141.33745396,  151.38575259,
                    161.64596242,  172.0954703 ,  182.70879082,  193.45763872,
                    204.31122288,  215.23675674,  226.20015938,  237.1668991 ,
                    248.10291251,  258.9755211 ,  269.75426817,  280.41161056,
                    290.92342133,  301.26928454,  311.43258789,  321.40043857,
                    331.16343932,  340.71536673,  350.05279198,  359.17467854,
                    368.08198397,  376.7772847 ,  385.2644357 ,  393.54827104,
                    401.63434697,  409.52872621,  417.23780022,  424.76814549,
                    432.12640909,  439.31921941,  446.35311759,  453.23450624,
                    459.96961208,  466.56445975,  473.02485455,  479.35637213,
                    485.56435361,  491.65390488,  497.63001868,  503.49843064,
                    509.26567631,  514.93793634,  520.5204486 ,  526.01753293,
                    531.43281418,  536.76943732,  542.03022261,  547.2177654 ,
                    552.33449685,  557.38272005,  562.36463153,  567.28268906,
                    572.14120628,  576.94536844,  581.69944558,  586.40651426,
                    591.06875806,  595.68779129,  600.26493938,  604.8023343 ,
                    609.30334284,  613.77092748,  618.20715617,  634.79242884,
                    639.30811921,  643.82278132,  648.32962669,  652.82361748,
                    657.3004026 ,  661.75627949,  666.1887799 ,  670.60681583,
                    675.14124992,  679.72630453,  684.30724064,  688.86452966,
                    693.39067611,  697.88413531,  702.75489049,  707.96377374,
                    712.96539346,  717.86333074,  722.86367531,  727.96329157,
                    733.09185623,  738.222882  ,  743.34586197,  748.45635507,
                    753.55233261,  758.63277675,  763.69711744,  768.74499374,
                    773.77614629,  778.79036538,  783.78746398,  788.76726292,
                    793.72958234,  798.67423677,  803.60103243,  808.50976591,
                    813.4002238 ,  818.27218296,  823.12541113,  827.95966788,
                    832.77470555,  837.57027038,  842.34610355,  847.10194228,
                    851.83752076,  856.55257113,  861.24682433,  865.92001088,
                    870.57186163,  875.20210837,  879.81048446,  884.39672537,
                    888.96056912,  893.50175677,  898.02003278,  902.5151454 ,
                    906.98684694,  911.43489413,  915.85904833,  920.2590758 ,
                    924.63474793,  928.98584142,  933.31213846,  937.61342692,
                    941.88950052,  946.1401589 ,  950.36520784,  954.56445931,
                    958.73773161,  962.88484947,  967.00564412,  971.09995341,
                    975.16762182,  979.20850062,  983.22244783,  987.20932834,
                    991.16901392,  995.10138331,  999.00632217, 1002.8837232 ,
                1006.73348607, 1010.55551753, 1014.34973134, 1018.11604832,
                1021.85439633, 1025.56471028, 1029.24693208, 1032.9010107 ,
                1036.52690205, 1040.12456904, 1043.6939815 , 1047.23511614,
                1050.74795656, 1054.23249316, 1057.68872307, 1061.11665018,
                1064.516285  , 1067.88764464, 1071.23075272, 1074.54563933,
                1077.83234094, 1081.09090032, 1084.32136645, 1087.52379447,
                1090.69824558, 1093.84478691, 1096.9634915 , 1100.05443814,
                1103.11771131, 1106.15340105, 1109.1616029 , 1112.14241774,
                1115.09595172, 1118.02231615, 1120.92162736, 1123.79400663,
                1126.63958001, 1129.45847828, 1132.25083679, 1135.01679533,
                1137.75649804, 1140.47009327, 1143.15773347, 1145.81957505,
                1148.45577828, 1151.06650713, 1153.65192921, 1156.21221557,
                1158.74754063, 1161.25808202, 1163.7440205 , 1166.20553978,
                1168.64282645, 1171.05606982, 1173.4454618 , 1175.81119681,
                1178.15372932, 1180.47465536, 1182.77534426, 1185.05567975,
                1187.31435983, 1189.54953685, 1191.75928004, 1193.94182143,
                1196.09565706, 1198.21956887, 1200.31260882, 1202.37406791,
                1204.40344137, 1206.40039551, 1208.36473818, 1210.29639346,
                1212.19538042, 1214.06179557, 1215.89579833, 1217.69759928,
                1219.46745041, 1221.20563728, 1222.91247254, 1224.58829075,
                1226.23344402, 1227.8482985 , 1229.43323154, 1230.98862926,
                1232.51488461, 1234.01239575, 1235.48156468, 1236.92279609,
                1238.33649645, 1239.72307315, 1241.08293385, 1242.41648589,
                1243.72413575, 1245.00628866, 1246.26334819, 1247.49571592,
                1248.70379115, 1249.88797065, 1251.04864842, 1252.18621546,
                1253.30105966, 1254.39356555, 1255.46411421, 1256.51308314,
                1257.54084608, 1258.547773  , 1259.53422991, 1260.50057886,
                1261.44717778, 1262.37438049, 1263.2825366 , 1264.17199147,
                1265.04308614, 1265.89615734, 1266.73153741, 1267.54955433,
                1268.35053161, 1269.13478837, 1269.90263927, 1270.65439452,
                1271.39035985, 1272.11083658, 1272.81612153, 1273.50650712,
                1274.1822813 , 1274.84372762, 1275.49112523, 1276.12474888,
                1276.74486898, 1277.3517516 , 1277.94565848, 1278.52684709,
                1279.09557066, 1279.65207819, 1280.1966145 , 1280.72942024,
                1281.25073199, 1281.76078222, 1282.25979938, 1282.74800791,
                1283.22562833, 1283.69287722, 1284.14996732, 1284.59710751,
                1285.03450293, 1285.46235498, 1285.88086136, 1286.29021614,
                1286.69060981, 1287.08222928, 1287.465258  , 1287.83987596,
                1288.20625974, 1288.56458256, 1288.91501436, 1289.2577218 ,
                1289.59286833, 1289.92061426, 1290.24111676, 1290.55452997,
                1290.86100497, 1291.16068989, 1291.45372995, 1291.74026748,
                1292.02044198, 1292.29439017, 1292.56224604, 1292.82414088,
                1293.08020334, 1293.33055948, 1293.57533278, 1293.81464424,
                1294.04861236, 1294.27735325, 1294.50098062, 1294.71960585,
                1294.93333801, 1295.14228393, 1295.34654822, 1295.54623333,
                1295.74143956, 1295.93226513, 1296.11880619, 1296.30115689,
                1296.47940941, 1296.65365396, 1296.82397887, 1296.9904706 ,
                1297.15321377, 1297.31229122, 1297.46778402, 1297.61977152,
                1297.76833136, 1297.91353954, 1298.05547042, 1298.19419679,
                1298.32978984, 1298.4562794 , 1298.52204601, 1298.46868493,
                1298.28345607, 1297.98552444, 1297.60409661, 1297.16691516,
                1296.69645024, 1296.20959501, 1295.71853748, 1295.23183152,
                1294.75533596, 1294.2929501 , 1293.84716234, 1293.41945027,
                1293.01056992, 1292.62076445, 1292.24991482, 1291.89764914,
                1291.56342218, 1291.24657349, 1290.94636996, 1290.66203702,
                1290.39278154, 1290.13780844, 1289.89633277, 1289.66758827,
                1289.4508334 , 1289.24535531, 1289.05047242, 1288.86553583,
                1288.68992992, 1288.52307234, 1288.36441347, 1288.21343566,
                1288.06965216, 1287.9326059 , 1287.80186819, 1287.67703734,
                1287.55773729, 1287.44361623, 1287.33434517, 1287.22961667,
                1287.12914353, 1287.03265754, 1286.93990829, 1286.85066207,
                1286.76470076, 1286.68182085, 1286.60183247, 1286.52455848,
                1286.44983365, 1286.37750384, 1286.3074253 , 1286.2394639 ,
                1286.17349456, 1286.10940056, 1286.04707306, 1285.98641047,
                1285.92731805, 1285.86970737, 1285.81349593, 1285.75860672,
                1285.70496786, 1285.65251228, 1285.60117733, 1285.55090452,
                1285.50163923, 1285.45333046, 1285.40593055, 1285.35939496,
                1285.31368209, 1285.26875303, 1285.22457143, 1285.18110327,
                1285.13831675, 1285.09618212, 1285.05467151, 1285.01375887,
                1284.97341978, 1284.93363138, 1284.89437224, 1284.85562229,
                1284.81736269, 1284.7795758 , 1284.74224503, 1284.70535484,
                1284.66889061, 1284.63283863, 1284.59718598, 1284.56192053,
                1284.52703087, 1284.49250624, 1284.45833652, 1284.42451217,
                1284.39102418, 1284.35786405, 1284.32502376, 1284.29249573,
                1284.2602728 , 1284.22834817, 1284.19671541, 1284.16536845,
                1284.13430149, 1284.10350906, 1284.07298593, 1284.04272717,
                1284.01272804, 1283.98298406, 1283.95349093, 1283.92424457,
                1283.89524108, 1283.86647671, 1283.83794788, 1283.80965118]), 'Металл (низ)': np.array([   0.        ,   26.52201192,   45.74145786,   57.14021562,
                    66.20707713,   74.16694868,   81.47675191,   88.38419039,
                    95.05785505,  101.62702371,  108.1956115 ,  114.84799489,
                    121.65231111,  128.6629357 ,  135.92257528,  143.46404831,
                    151.31175148,  159.48281342,  167.98795555,  176.83209413,
                    186.01472815,  195.53016413,  205.36763485,  215.51137272,
                    225.94070119,  236.63020612,  247.55004289,  258.66642153,
                    269.94229146,  281.33822064,  292.81343425,  304.32695113,
                    315.83873709,  327.31078786,  338.7080619 ,  349.9992031 ,
                    361.15702073,  372.15872276,  382.98592384,  393.62446645,
                    404.06410298,  414.29808727,  424.32271961,  434.13688111,
                    443.74158404,  453.13955611,  462.33486874,  471.33261391,
                    480.13862944,  488.7592703 ,  497.20122151,  505.47134778,
                    513.57657458,  521.52379582,  529.31980352,  536.97123552,
                    544.48453769,  551.86593785,  559.12142887,  566.25675888,
                    573.27742712,  580.20752916,  587.05585731,  593.81126065,
                    600.47470144,  607.04953573,  613.53952857,  619.94842263,
                    626.27983884,  632.53724902,  638.72396535,  644.84313625,
                    650.89774659,  656.89062135,  662.8251466 ,  668.71171308,
                    674.55548461,  680.35657273,  686.11497918,  691.83127553,
                    697.50647425,  703.65516329,  710.18176435,  716.42281796,
                    722.52229797,  728.53737741,  734.49324125,  740.65876246,
                    746.67671061,  752.23136914,  757.49708219,  762.55551173,
                    767.74343627,  772.99108505,  778.1551706 ,  783.20362044,
                    788.13580042,  792.95902152,  797.68194313,  802.31256456,
                    806.86284226,  811.39396118,  815.92722464,  820.44618435,
                    824.934893  ,  829.38423975,  833.7985228 ,  838.1916259 ,
                    842.5736504 ,  846.94963506,  851.32096259,  855.68692633,
                    860.04584553,  864.39571922,  868.73456055,  873.06054362,
                    877.37205109,  881.66767436,  885.94619393,  890.20655363,
                    894.44783516,  898.66923545,  902.87004748,  907.04964466,
                    911.20746798,  915.34301589,  919.45583598,  923.54551847,
                    927.61169079,  931.65401331,  935.67217577,  939.66589439,
                    943.63490943,  947.57898316,  951.49789819,  955.39145595,
                    959.2594755 ,  963.10179238,  966.91825771,  970.70873736,
                    974.47311115,  978.21127225,  981.92312657,  985.60859217,
                    989.26759884,  992.90008762,  996.50601034, 1000.08532929,
                1003.63801684, 1007.16405508, 1010.6634355 , 1014.13615871,
                1017.58223413, 1021.00167972, 1024.3945217 , 1027.76079429,
                1031.1005395 , 1034.41380686, 1037.70065316, 1040.96114229,
                1044.19534497, 1047.40333856, 1050.58520683, 1053.74103976,
                1056.87093337, 1059.97498948, 1063.05331553, 1066.10602442,
                1069.13323429, 1072.13506835, 1075.11165471, 1078.06312618,
                1080.98962012, 1083.89127829, 1086.76824663, 1089.62067513,
                1092.44871769, 1095.2525319 , 1098.03227895, 1100.78812345,
                1103.52023327, 1106.22877941, 1108.91393586, 1111.57587944,
                1114.21478967, 1116.83084865, 1119.42424088, 1121.9951532 ,
                1124.5437746 , 1127.07029612, 1129.57491073, 1132.05781319,
                1134.51919995, 1136.95926903, 1139.37821991, 1141.7762534 ,
                1144.15357156, 1146.51037757, 1148.84687562, 1151.16327086,
                1153.45976924, 1155.73657744, 1157.99390276, 1160.23195307,
                1162.45093667, 1164.65106222, 1166.83253867, 1168.99557515,
                1171.14038091, 1173.26716523, 1175.37613734, 1177.46750635,
                1179.5414812 , 1181.59827054, 1183.63808269, 1185.66112559,
                1187.66760669, 1189.65773294, 1191.63171067, 1193.58974561,
                1195.53204273, 1197.45880628, 1199.37023968, 1201.43856994,
                1203.19282167, 1204.7719494 , 1206.25091604, 1207.65805148,
                1209.00745843, 1210.30771065, 1211.56469577, 1212.7827658 ,
                1213.96529421, 1215.11498316, 1216.23404946, 1217.32434543,
                1218.38744202, 1219.42468857, 1220.43725735, 1221.42617748,
                1222.39236142, 1223.33662577, 1224.2597079 , 1225.16227919,
                1226.04495581, 1226.90830736, 1227.75286394, 1228.57912191,
                1229.38754858, 1230.17858609, 1230.95265463, 1231.71015502,
                1232.45147095, 1233.17697084, 1233.88700929, 1234.58192846,
                1235.26205915, 1235.92772171, 1236.57922687, 1237.21687641,
                1237.84096379, 1238.45177465, 1239.04958727, 1239.63467298,
                1240.20729654, 1240.76771641, 1241.31618506, 1241.85294927,
                1242.37825028, 1242.89232408, 1243.39540156, 1243.8877087 ,
                1244.36946673, 1244.84089227, 1245.30219751, 1245.75359029,
                1246.19527426, 1246.62744896, 1247.05030995, 1247.46404891,
                1247.86885372, 1248.26490856, 1248.65239399, 1249.03148705,
                1249.40236129, 1249.7651869 , 1250.12013075, 1250.46735644,
                1250.80702443, 1251.13929202, 1251.46431346, 1251.78224003,
                1252.09322002, 1252.39739886, 1252.69491913, 1252.98592065,
                1253.27054048, 1253.54891301, 1253.82117   , 1254.08744061,
                1254.34785147, 1254.6025267 , 1254.85158798, 1255.09515459,
                1255.33334341, 1255.56626905, 1255.79404378, 1256.01677768,
                1256.23457858, 1256.44755219, 1256.65580206, 1256.85942968,
                1257.05853448, 1257.25321388, 1257.44356332, 1257.6296763 ,
                1257.81164442, 1257.9895574 , 1258.16350314, 1258.33356771,
                1258.49983545, 1258.66238892, 1258.821309  , 1258.9766749 ,
                1259.12856416, 1259.27705275, 1259.42221501, 1259.56412378,
                1259.70285034, 1259.83846449, 1259.97103456, 1260.10062746,
                1260.22730867, 1260.3511423 , 1260.4721911 , 1260.59051649,
                1260.7061786 , 1260.81923627, 1260.92974708, 1261.0377674 ,
                1261.14335238, 1261.24655602, 1261.34743112, 1261.44602938,
                1261.54240138, 1261.63659661, 1261.72866349, 1261.8186494 ,
                1261.90660071, 1261.99256276, 1262.07657992, 1262.1586956 ,
                1262.23895227, 1262.31739148, 1262.39405384, 1262.46897913,
                1262.54220623, 1262.61377316, 1262.68371714, 1262.75207455,
                1262.81888098, 1262.88417125, 1262.9479794 , 1263.01033873,
                1265.44318847, 1267.96627555, 1269.70887568, 1271.10826178,
                1272.31828742, 1273.4054281 , 1274.40361864, 1275.33207982,
                1276.20228601, 1277.02126081, 1277.79339253, 1278.5215271 ,
                1279.20764767, 1279.85329489, 1280.45981841, 1281.02851886,
                1281.56072003, 1282.05779827, 1282.52118677, 1282.9523664 ,
                1283.35285032, 1283.72416659, 1284.06784137, 1284.38538388,
                1284.67827381, 1284.94795114, 1285.19580829, 1285.42318444,
                1285.6313616 , 1285.82156225, 1285.99494819, 1286.15262038,
                1286.29561959, 1286.42492761, 1286.54146895, 1286.64611283,
                1286.73967539, 1286.82292207, 1286.89657004, 1286.96129068,
                1287.01771205, 1287.06642127, 1287.10796693, 1287.14286133,
                1287.17158273, 1287.19457737, 1287.21226156, 1287.22502353,
                1287.23322523, 1287.23720406, 1287.23727444, 1287.23372935,
                1287.22684173, 1287.21686583, 1287.20403843, 1287.18858003,
                1287.17069595, 1287.15057732, 1287.12840209, 1287.10433587,
                1287.07853282, 1287.05113638, 1287.02228002, 1286.99208792,
                1286.96067561, 1286.92815054, 1286.89461266, 1286.8601549 ,
                1286.82486367, 1286.78881931, 1286.7520965 , 1286.71476464,
                1286.67688821, 1286.63852714, 1286.59973707, 1286.56056969,
                1286.52107298, 1286.4812915 , 1286.44126658, 1286.40103656,
                1286.36063703, 1286.32010097, 1286.27945894, 1286.23873927,
                1286.1979682 , 1286.15717   , 1286.11636717, 1286.07558048,
                1286.03482915, 1285.99413094, 1285.95350223, 1285.91295816,
                1285.87251266, 1285.83217859, 1285.79196776, 1285.75189105,
                1285.71195846, 1285.67217913, 1285.63256149, 1285.5931132 ,
                1285.55384129, 1285.51475217, 1285.47585167, 1285.43714509,
                1285.39863723, 1285.36033243, 1285.32223461, 1285.28434728,
                1285.24667358, 1285.20921632, 1285.17197797, 1285.13496072,
                1285.09816648, 1285.06159689, 1285.02525338, 1284.98913715])}}

            self.update(data)

        self.toplevel = None

    def open_exp(self, id):
        exp = self.database.get_experiment_by_id(id)
        #res = exp.results
        self.show_exp(exp)

    def start_up(self):
        exp = self.database.get_last_experiment()
        #res = exp.results
        self.show_exp(exp)

    def parse_heating_data(self, exp):

        heating_data = {
            "Расчет нагрева металла": {},
            "Тепловой баланс" : {},
            "График": {},
            "data": {},
            "t_data": {}
        }
        
 
        # metal heating
        for zone in exp.metal_results[0].zones:
            #print(zone.name)
            heating_data["Расчет нагрева металла"][zone.name] = {}

            for param in zone.parameters:
                heating_data["Расчет нагрева металла"][zone.name][param.name + "," + param.units] = param.value

        for param in exp.metal_results[0].parameters:
            #print(param.name)
            heating_data["Расчет нагрева металла"][param.name + "," + param.units] = param.value

        for zone in exp.balance_results[0].zones:
            #print(zone.name)
            heating_data["Тепловой баланс"][zone.name] = {}

            for heat_flow in zone.heat_flows:
                #print(heat_flow.type)
                heating_data["Тепловой баланс"][zone.name][heat_flow.type] = {}

                for detail in heat_flow.details:
                    #print(detail.name)
                    heating_data["Тепловой баланс"][zone.name][heat_flow.type][detail.name + "," + detail.units] = detail.value
            
            for param in zone.params:
                #print(param.name)
                heating_data["Тепловой баланс"][zone.name][param.name + "," + param.units] = param.value

        for param in exp.heat_graphs[0].params:
            #print(param.name)
            heating_data["График"][param.name] = param.value

        for dot in exp.heat_graphs[0].dots:
            #print(dot.name)
            heating_data["График"][dot.name] = [data.value for data in dot.data]
        # e = exp.history_parameters

        tmn = 0.0
        twMetn = 0.0
        twDif = 0.0

        for param in exp.history_parameters:
            if(param.parameter_name == "Время нагрева (time_H)" or param.parameter_name == "Время в методической зоне" or param.parameter_name == "Время в первой сварочной зоне" or param.parameter_name == "Время во второй сварочной зоне" or param.parameter_name == "Время в томильной зоне"):
                heating_data["data"][param.parameter_name] = param.value

            if(param.parameter_name == "Начальная температура металла (tmn)"):
                tmn = param.value
            elif(param.parameter_name == "Температура методической зоны (twMetn)"):
                twMetn = param.value
            elif(param.parameter_name == "Разница температур при посаде (twDif)"):
                twDif = param.value

            #print(param.parameter_name)

        heating_data["t_data"]["Температура сляба при посаде"] = tmn
        heating_data["t_data"]["Температура верха печи при посаде"] = twMetn
        heating_data["t_data"]["Температура низа печи при посаде"] = twMetn - twDif
        print("heating_data")
        print(heating_data)
        print("####")
        self.set_heating_data(heating_data)
        
    def show_exp(self, exp):
        res = exp.results

        self.parse_heating_data(exp)

        data = []

        cards = {}

        for el in res:
            if("CO2" in el.parameter or "N2" in el.parameter or "H2O" in el.parameter or "O2" in el.parameter):
                cards[el.parameter] = el.value
            else:
                if("%" in el.parameter or "тг" in el.parameter):
                    data.append((el.parameter, toFixed(el.value, 1)))
                else:
                    data.append((el.parameter, toFixed(el.value, 3)))
            
        data.insert(2, ("cards", cards))

        self.update(data)

    def _clear(self):
# Для устранения memory leak от matplotlib (работает не очень, но работает)
        if (len(self.figures) > 0):
            plt.close('all')
            self.figures.clear()

        for widget in self.winfo_children():
            widget.destroy()
    
    def get_data(self):
        return self.data
    
    def get_heating_data(self):
        return self.heating_data
    
    def update(self, data):
        self._clear()
        self.data = data

        # self.label = ctk.CTkLabel(
        #     self, text="Расчет горения топлива", font=ctk.CTkFont(size=18, weight="bold"), text_color='white'
        # )
        # self.label.grid(row=0, column=0, columnspan=2, padx=20, pady=(10, 0))
        
        row = 0
        column = 0
        index = 0
        size = self.small_row_size

        self.row_frames = []

        self.card_bg_color = 'white'
        self.text_color = 'black'

        frame = ctk.CTkFrame(self, fg_color='transparent')
        frame.grid(row=0, column=0, columnspan=2, padx=0, pady=(20, 0))

        frame_l = ctk.CTkFrame(frame, fg_color='transparent')
        frame_l.grid(row=0, column=0, padx=(20, 0), pady=(20, 0))

        frame_r = ctk.CTkFrame(frame, fg_color='transparent')
        frame_r.grid(row=0, column=1, padx=(0, 20), pady=(0, 0))

        self.row_frames.append(frame_r)

            # Добавление карточек
        for idx, (label, value) in enumerate(data):
            tag = "tag-" + str(idx)
            if('%' in label):
                self.create_card_percent(frame=self.row_frames[index], row=row, column=column, title=label, value=value, tag=tag)
            elif('cards' in label):
                # Карточка для состава дыма
                self.create_combined_card(title="Состав дыма",frame=frame_l,row=0, column=0, value=value, tag=tag)
                continue
            else:
                self.create_card_value(frame=self.row_frames[index], row=row, column=column, title=label, value=value, tag=tag)
            
            column += 1
            
            if(column >= size):
                column = 0
                row += 1
                if(row > 1 or index > 0):
                    frame = ctk.CTkFrame(self, fg_color='transparent')
                    frame.grid(row=row + 2, column=column, columnspan=2, padx=20, pady=0)
                    frame.rowconfigure((0), weight=1)
                    self.row_frames.append(frame)
                    
                    index = len(self.row_frames) - 1
                    size = self.large_row_size

    def __change_cursor(self, cursor):
        root = self.root
        root.config(cursor=cursor)

    def __frame_on_enter(self, *frame):
        self.__change_cursor('hand2')
    
    def __frame_on_exit(self, *frame):
        self.__change_cursor('arrow')

    def __frame_on_click(self, frame, title, event):
        toplevel = DatasetWindow(self, self.database, title)
        toplevel.after(10, toplevel.lift)
        

    def create_card_percent(self, frame, row, column, title, value, tag):
        """Создание одной карточки с круговой диаграммой."""
        frame = ctk.CTkFrame(frame, corner_radius=10, fg_color=self.card_bg_color, width=self.card_size, height=self.card_size)
        frame.grid(row=row, column=column, padx=10, pady=10, sticky="nsew")
        frame.bindtags((tag,) + frame.bindtags())

        label = ctk.CTkLabel(frame, text=title, font=("Arial", 14, "bold"), text_color=self.text_color)
        label.pack(padx=10, pady=(10,0))
        label.bindtags((tag,) + label.bindtags())

        # Построение круговой диаграммы
        fig, ax = plt.subplots(figsize=(self.chart_size, self.chart_size))
        fig.set_facecolor(self.card_bg_color)
        ax.set_facecolor(self.card_bg_color)
        ax.pie([value, 100 - float(value)], labels=["", ""], colors=["#4CAF50", "#E0E0E0"], startangle=90)
        ax.text(0, 0, f"{value}%", ha="center", va="center", fontsize=12, color="black")

        self.figures.append(fig)
        
        canvas = FigureCanvasTkAgg(fig, master=frame)
        tk_w = canvas.get_tk_widget()
        tk_w.bindtags((tag,) + tk_w.bindtags())
        tk_w.pack(fill='both', pady=(0, 10))
        canvas.draw()

        frame.master.bind_class(tag, "<Enter>", partial(self.__frame_on_enter, frame))
        frame.master.bind_class(tag, "<Leave>", partial(self.__frame_on_exit, frame))
        frame.master.bind_class(tag, "<ButtonPress-1>", partial(self.__frame_on_click, frame, title))
        label.bind("<Button-1>", partial(self.__frame_on_click, frame, title))


    def create_card_value(self, frame, row, column, title, value, tag):
        """Создание одной карточки с круговой диаграммой."""
        frame = ctk.CTkFrame(frame, corner_radius=10, fg_color=self.card_bg_color, width=self.card_size, height=self.card_size)
        frame.grid(row=row, column=column, padx=10, pady=10, sticky="snew")
        frame.bindtags((tag,) + frame.bindtags())

        label = ctk.CTkLabel(frame, text=title, font=("Arial", 14, "bold"), text_color=self.text_color)
        label.pack(padx=10, pady=(10, 0))
        label.bindtags((tag,) + label.bindtags())

        value_frame = ctk.CTkFrame(frame, fg_color='transparent')
        value_frame.pack(padx=10, pady=40, expand=True)
        value_frame.bindtags((tag,) + value_frame.bindtags())

        value = ctk.CTkLabel(value_frame, text=value, font=("Arial", 24, "bold"), text_color=self.text_color)
        value.pack()
        value.bindtags((tag,) + value.bindtags())

        frame.master.bind_class(tag, "<Enter>", partial(self.__frame_on_enter, frame))
        frame.master.bind_class(tag, "<Leave>", partial(self.__frame_on_exit, frame))
        frame.master.bind_class(tag, "<ButtonPress-1>", partial(self.__frame_on_click, frame, title))

        # frame.bind("<Enter>", partial(self.__frame_on_enter, frame))
        # frame.bind("<Leave>", partial(self.__frame_on_exit, frame))
        frame.bind("<Button-1>", partial(self.__frame_on_click, frame, title))
        label.bind("<Button-1>", partial(self.__frame_on_click, frame, title))
        value.bind("<Button-1>", partial(self.__frame_on_click, frame, title))

    def create_combined_card(self, title, frame, row, column, value, tag):
        """Создание карточки для состава дыма с несколькими диаграммами."""
        frame = ctk.CTkFrame(frame, corner_radius=10, fg_color=self.card_bg_color, width=self.card_size, height=self.card_size)
        frame.grid(row=row, column=column, padx=10, pady=10, sticky="nsew")
        frame.bindtags((tag,) + frame.bindtags())

        fig, ax = plt.subplots(figsize=(self.chart_size + 1, self.chart_size + 2))
        fig.set_facecolor(self.card_bg_color)
        ax.set_facecolor(self.card_bg_color)
        ax.bar(value.keys(), value.values(), color=["#4CAF50", "#2196F3", "#FFC107", "#F44336"])
        ax.set_ylabel("%")
        ax.set_title(title)

        self.figures.append(fig)

        canvas = FigureCanvasTkAgg(fig, master=frame)
        tk_w = canvas.get_tk_widget()
        tk_w.bindtags((tag,) + tk_w.bindtags())
        tk_w.pack(fill='both', pady=10)
        canvas.draw()

        frame.master.bind_class(tag, "<Enter>", partial(self.__frame_on_enter, frame))
        frame.master.bind_class(tag, "<Leave>", partial(self.__frame_on_exit, frame))
        frame.master.bind_class(tag, "<ButtonPress-1>", partial(self.__frame_on_click, frame, value))

    def show_result(self, data):
        res = [
            # ("pie", data[0]),
            ("Низшая рабочая теплота\nсгорания смеси, ккал/м³ (при 20°C)", toFixed(data[4], 3)),
            ("Цена смешанного газа, тг/1000м³", toFixed(data[2], 1)),
            ("cards", data[5]),
            ("Плотность газа при н.у., кг/м³", toFixed(data[6], 3)),
            ("Действительный расход воздуха, м³/м³", toFixed(data[7], 3)),
            ("Удельный выход дыма, м³/м³", toFixed(data[8], 3)),
            ("Теплоёмкость дыма, Дж/(м³·К)", toFixed(data[9], 3)),
            ("Калориметрическая температура, °C", toFixed(data[10], 3)),
            ("Действительная температура, °C", toFixed(data[11], 3)),
        ]

        # Вставка значений сгорания газов
        for row, (key, value) in enumerate(data[1].items()):
            res.insert(1 + row, (f"Конечная стоимость\n{key}, тг/1000м³", toFixed(value, 1)))

        # Вставка значений сгорания газов
        for row, (key, value) in enumerate(data[3].items()):
            res.insert(0 + row, (f"Низшая рабочая теплота\nсгорания - {key},\nккал/м³ (при 20°C)", toFixed(value, 3)))

        for row, (key, value) in enumerate(data[0].items()):
            res.insert(0 + row, (f"{key}, %", toFixed(value, 1)))

        self.update(res)

        return res, data[12]

    def set_heating_data(self, heating_data):

        self.heating_data = heating_data

